/*! Raygun4js - v1.8.0 - 2014-03-25
* https://github.com/MindscapeHQ/raygun4js
* Copyright (c) 2014 MindscapeHQ; Licensed MIT */
(function(e){function n(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function t(e){return e===undefined}var r={},a=e.TraceKit,i=[].slice,u="?";r.noConflict=function(){return e.TraceKit=a,r},r.wrap=function(e){function n(){try{return e.apply(this,arguments)}catch(n){throw r.report(n),n}}return n},r.report=function(){function t(e){c.push(e)}function a(e){for(var n=c.length-1;n>=0;--n)c[n]===e&&c.splice(n,1)}function u(e,t){var a=null;if(!t||r.collectWindowErrors){for(var u in c)if(n(c,u))try{c[u].apply(null,[e].concat(i.call(arguments,2)))}catch(o){a=o}if(a)throw a}}function o(n){var t=i.call(arguments,1);if(s){if(l===n)return;var a=s;s=null,l=null,u.apply(null,[a,null].concat(t))}var o=r.computeStackTrace(n);throw s=o,l=n,e.setTimeout(function(){l===n&&(s=null,l=null,u.apply(null,[o,null].concat(t)))},o.incomplete?2e3:0),n}var c=[],l=null,s=null,f=e.onerror;return e.onerror=function(e,n,t,a,i){var o=null;if(i)o=r.computeStackTrace(i);else if(s)r.computeStackTrace.augmentStackTraceWithInitialElement(s,n,t,e),o=s,s=null,l=null;else{var c={url:n,line:t,column:a};c.func=r.computeStackTrace.guessFunctionName(c.url,c.line),c.context=r.computeStackTrace.gatherContext(c.url,c.line),o={mode:"onerror",message:e,url:document.location.href,stack:[c],useragent:navigator.userAgent}}return u(o,"from window.onerror"),f?f.apply(this,arguments):!1},o.subscribe=t,o.unsubscribe=a,o}(),r.computeStackTrace=function(){function a(n){function t(){try{return new e.XMLHttpRequest}catch(n){return new e.ActiveXObject("Microsoft.XMLHTTP")}}if(!r.remoteFetching)return"";try{var a=t();return a.open("GET",n,!1),a.send(""),a.responseText}catch(i){return""}}function i(e){if(!n(k,e)){var t="";-1!==e.indexOf(document.domain)&&(t=a(e)),k[e]=t?t.split("\n"):[]}return k[e]}function o(e,n){var r,a=/function ([^(]*)\(([^)]*)\)/,o=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,c="",l=10,s=i(e);if(!s.length)return u;for(var f=0;l>f;++f)if(c=s[n-f]+c,!t(c)){if(r=o.exec(c))return r[1];if(r=a.exec(c))return r[1]}return u}function c(e,n){var a=i(e);if(!a.length)return null;var u=[],o=Math.floor(r.linesOfContext/2),c=o+r.linesOfContext%2,l=Math.max(0,n-o-1),s=Math.min(a.length,n+c-1);n-=1;for(var f=l;s>f;++f)t(a[f])||u.push(a[f]);return u.length>0?u:null}function l(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function s(e){return l(e).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function f(e,n){for(var t,r,a=0,u=n.length;u>a;++a)if((t=i(n[a])).length&&(t=t.join("\n"),r=e.exec(t)))return{url:n[a],line:t.substring(0,r.index).split("\n").length,column:r.index-t.lastIndexOf("\n",r.index)-1};return null}function g(e,n,t){var r,a=i(n),u=RegExp("\\b"+l(e)+"\\b");return t-=1,a&&a.length>t&&(r=u.exec(a[t]))?r.index:null}function p(n){for(var t,r,a,i,u=[e.location.href],o=document.getElementsByTagName("script"),c=""+n,g=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,p=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,h=0;o.length>h;++h){var m=o[h];m.src&&u.push(m.src)}if(a=g.exec(c)){var d=a[1]?"\\s+"+a[1]:"",v=a[2].split(",").join("\\s*,\\s*");t=l(a[3]).replace(/;$/,";?"),r=RegExp("function"+d+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+t+"\\s*}")}else r=RegExp(l(c).replace(/\s+/g,"\\s+"));if(i=f(r,u))return i;if(a=p.exec(c)){var y=a[1];if(t=s(a[2]),r=RegExp("on"+y+"=[\\'\"]\\s*"+t+"\\s*[\\'\"]","i"),i=f(r,u[0]))return i;if(r=RegExp(t),i=f(r,u))return i}return null}function h(e){if(!e.stack)return null;for(var n,t,r=/^\s*at (?:((?:\[object object\])?\S+) )?\(?((?:file|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,a=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http|https).*?):(\d+)(?::(\d+))?\s*$/i,i=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:ms-appx|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,l=e.stack.split("\n"),s=[],f=/^(.*) is undefined$/.exec(e.message),p=0,h=l.length;h>p;++p){if(n=a.exec(l[p]))t={url:n[3],func:n[1]||u,args:n[2]?n[2].split(","):"",line:+n[4],column:n[5]?+n[5]:null};else if(n=r.exec(l[p]))t={url:n[2],func:n[1]||u,line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=i.exec(l[p])))continue;t={url:n[2],func:n[1]||u,line:+n[3],column:n[4]?+n[4]:null}}!t.func&&t.line&&(t.func=o(t.url,t.line)),t.line&&(t.context=c(t.url,t.line)),s.push(t)}return s[0]&&s[0].line&&!s[0].column&&f&&(s[0].column=g(f[1],s[0].url,s[0].line)),s.length?{mode:"stack",name:e.name,message:e.message,url:document.location.href,stack:s,useragent:navigator.userAgent}:null}function m(e){for(var n,t=e.stacktrace,r=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,a=t.split("\n"),i=[],u=0,l=a.length;l>u;u+=2)if(n=r.exec(a[u])){var s={line:+n[1],column:+n[2],func:n[3]||n[4],args:n[5]?n[5].split(","):[],url:n[6]};if(!s.func&&s.line&&(s.func=o(s.url,s.line)),s.line)try{s.context=c(s.url,s.line)}catch(f){}s.context||(s.context=[a[u+1]]),i.push(s)}return i.length?{mode:"stacktrace",name:e.name,message:e.message,url:document.location.href,stack:i,useragent:navigator.userAgent}:null}function d(t){var r=t.message.split("\n");if(4>r.length)return null;var a,u,l,g,p=/^\s*Line (\d+) of linked script ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,h=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,m=/^\s*Line (\d+) of function script\s*$/i,d=[],v=document.getElementsByTagName("script"),y=[];for(u in v)n(v,u)&&!v[u].src&&y.push(v[u]);for(u=2,l=r.length;l>u;u+=2){var w=null;if(a=p.exec(r[u]))w={url:a[2],func:a[3],line:+a[1]};else if(a=h.exec(r[u])){w={url:a[3],func:a[4]};var x=+a[1],S=y[a[2]-1];if(S&&(g=i(w.url))){g=g.join("\n");var k=g.indexOf(S.innerText);k>=0&&(w.line=x+g.substring(0,k).split("\n").length)}}else if(a=m.exec(r[u])){var T=e.location.href.replace(/#.*$/,""),b=a[1],j=RegExp(s(r[u+1]));g=f(j,[T]),w={url:T,line:g?g.line:b,func:""}}if(w){w.func||(w.func=o(w.url,w.line));var R=c(w.url,w.line),C=R?R[Math.floor(R.length/2)]:null;w.context=R&&C.replace(/^\s*/,"")===r[u+1].replace(/^\s*/,"")?R:[r[u+1]],d.push(w)}}return d.length?{mode:"multiline",name:t.name,message:r[0],url:document.location.href,stack:d,useragent:navigator.userAgent}:null}function v(e,n,t,r){var a={url:n,line:t};if(a.url&&a.line){e.incomplete=!1,a.func||(a.func=o(a.url,a.line)),a.context||(a.context=c(a.url,a.line));var i=/ '([^']+)' /.exec(r);if(i&&(a.column=g(i[1],a.url,a.line)),e.stack.length>0&&e.stack[0].url===a.url){if(e.stack[0].line===a.line)return!1;if(!e.stack[0].line&&e.stack[0].func===a.func)return e.stack[0].line=a.line,e.stack[0].context=a.context,!1}return e.stack.unshift(a),e.partial=!0,!0}return e.incomplete=!0,!1}function y(e,n){for(var t,a,i,c=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,l=[],s={},f=!1,h=y.caller;h&&!f;h=h.caller)if(h!==w&&h!==r.report){if(a={url:null,func:u,line:null,column:null},h.name?a.func=h.name:(t=c.exec(""+h))&&(a.func=t[1]),i=p(h)){a.url=i.url,a.line=i.line,a.func===u&&(a.func=o(a.url,a.line));var m=/ '([^']+)' /.exec(e.message||e.description);m&&(a.column=g(m[1],i.url,i.line))}s[""+h]?f=!0:s[""+h]=!0,l.push(a)}n&&l.splice(0,n);var d={mode:"callers",name:e.name,message:e.message,url:document.location.href,stack:l,useragent:navigator.userAgent};return v(d,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),d}function w(e,n){var t=null;n=null==n?0:+n;try{if(t=m(e))return t}catch(r){if(S)throw r}try{if(t=h(e))return t}catch(r){if(S)throw r}try{if(t=d(e))return t}catch(r){if(S)throw r}try{if(t=y(e,n+1))return t}catch(r){if(S)throw r}return{mode:"failed"}}function x(e){e=(null==e?0:+e)+1;try{throw Error()}catch(n){return w(n,e+1)}return null}var S=!1,k={};return w.augmentStackTraceWithInitialElement=v,w.guessFunctionName=o,w.gatherContext=c,w.ofCaller=x,w}(),function(){var n=function n(n){var t=e[n];e[n]=function(){var e=i.call(arguments),n=e[0];return"function"==typeof n&&(e[0]=r.wrap(n)),t.apply?t.apply(this,e):t(e[0],e[1])}};n("setTimeout"),n("setInterval")}(),function(e){if(e){var n=e.event.add;e.event.add=function(t,a,i,u,o){var c;return i.handler?(c=i.handler,i.handler=r.wrap(i.handler)):(c=i,i=r.wrap(i)),i.guid=c.guid?c.guid:c.guid=e.guid++,n.call(this,t,a,i,u,o)};var t=e.fn.ready;e.fn.ready=function(e){return t.call(this,r.wrap(e))};var a=e.ajax;e.ajax=function(n){for(var t,i=["complete","error","success"];t=i.pop();)e.isFunction(n[t])&&(n[t]=r.wrap(n[t]));try{return a.call(this,n)}catch(u){throw r.report(u),u}}}}(e.jQuery),r.remoteFetching||(r.remoteFetching=!0),r.collectWindowErrors||(r.collectWindowErrors=!0),(!r.linesOfContext||1>r.linesOfContext)&&(r.linesOfContext=11),e.TraceKit=r})(window),function(e,n){"use strict";if(e){var t=e.event.add;e.event.add=function(r,a,i,u,o){var c;return i.handler?(c=i.handler,i.handler=n.wrap(i.handler)):(c=i,i=n.wrap(i)),i.guid=c.guid?c.guid:c.guid=e.guid++,t.call(this,r,a,i,u,o)};var r=e.fn.ready;e.fn.ready=function(e){return r.call(this,n.wrap(e))};var a=e.ajax;e.ajax=function(t,r){"object"==typeof t&&(r=t,t=void 0),r=r||{};for(var i,u=["complete","error","success"];i=u.pop();)e.isFunction(r[i])&&(r[i]=n.wrap(r[i]));try{return t?a.call(this,t,r):a.call(this,r)}catch(o){throw n.report(o),o}}}}(window.jQuery,window.TraceKit),function(e,n,t){function r(e,n,r,a){C.send(a||e.type,{status:n.status,statusText:n.statusText,type:r.type,url:r.url,contentType:r.contentType,data:r.data?r.data.slice(0,10240):t})}function a(n){e.console&&e.console.log&&S&&e.console.log(n)}function i(){return m&&""!==m?!0:(a("Raygun API key has not been configured, make sure you call Raygun.init(yourApiKey)"),!1)}function u(e,n){var t,r={};for(t in e)r[t]=e[t];for(t in n)r[t]=n[t];return r}function o(e,n){return null!=n?e.concat(n):e}function c(e,n){for(var t=0;e.length>t;t++)n.call(null,t,e[t])}function l(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}function s(){var n=document.documentElement,t=document.getElementsByTagName("body")[0],r=e.innerWidth||n.clientWidth||t.clientWidth,a=e.innerHeight||n.clientHeight||t.clientHeight;return{width:r,height:a}}function f(n,r){var a=[],i={};n.stack&&n.stack.length&&c(n.stack,function(e,n){a.push({LineNumber:n.line,ColumnNumber:n.column,ClassName:"line "+n.line+", column "+n.column,FileName:n.url,MethodName:n.func||"[anonymous]"})}),e.location.search&&e.location.search.length>1&&c(e.location.search.substring(1).split("&"),function(e,n){var t=n.split("=");t&&2===t.length&&(i[decodeURIComponent(t[0])]=t[1])}),r===t&&(r={}),l(r.customData)&&(r.customData=b),l(r.tags)&&(r.tags=j);var u=e.screen||{width:s().width,height:s().height,colorDepth:8},o={OccurredOn:new Date,Details:{Error:{ClassName:n.name,Message:n.message||r.status||"Script error",StackTrace:a},Environment:{UtcOffset:(new Date).getTimezoneOffset()/-60,"User-Language":navigator.userLanguage,"Document-Mode":document.documentMode,"Browser-Width":s().width,"Browser-Height":s().height,"Screen-Width":u.width,"Screen-Height":u.height,"Color-Depth":u.colorDepth,Browser:navigator.appCodeName,"Browser-Name":navigator.appName,"Browser-Version":navigator.appVersion,Platform:navigator.platform},Client:{Name:"raygun-js",Version:"1.8.0"},UserCustomData:r.customData,Tags:r.tags,Request:{Url:document.location.href,QueryString:i,Headers:{"User-Agent":navigator.userAgent,Referer:document.referrer,Host:document.domain}},Version:v||"Not supplied"}};d&&(o.Details.User=d),g(o)}function g(e){if(i()){a("Sending exception data to Raygun:",e);var n=R+"/entries?apikey="+encodeURIComponent(m);h(n,JSON.stringify(e))}}function p(n,t,r){var i,u=function(){for(var e=(new Date).toISOString(),n=null;localStorage["raygunjs="+e+n];)n+=1;try{null!=n?localStorage["raygunjs="+e+"="+n]=r:localStorage["raygunjs="+e]=r}catch(t){a("Raygun4JS: LocalStorage full, cannot save exception")}};return i=new e.XMLHttpRequest,"withCredentials"in i?(i.open(n,t,!0),i.onreadystatechange=function(){if(4===i.readyState)if(202===i.status)for(var e in localStorage)"raygunjs="===e.substring(0,9)&&(g(JSON.parse(localStorage[e])),localStorage.removeItem(e));else T&&403!==i.status&&400!==i.status&&u()},i.onload=function(){a("logged error to Raygun")}):e.XDomainRequest&&(k&&(t=t.slice(6)),i=new e.XDomainRequest,i.open(n,t),i.ontimeout=function(){T&&u()},i.onload=function(){for(var e in localStorage)"raygunjs="===e.substring(0,9)&&(g(JSON.parse(localStorage[e])),localStorage.removeItem(e))}),i.timeout=1e3,i.onerror=function(){a("failed to log error to Raygun")},i}function h(e,n){var r=p("POST",e,n);return r?(r.send(n),t):(a("CORS not supported"),t)}var m,d,v,y,w=TraceKit.noConflict(),x=e.Raygun,S=!1,k=!1,T=!1,b={},j=[],R="https://api.raygun.io";n&&(y=n(document));var C={noConflict:function(){return e.Raygun=x,C},init:function(e,n,t){return m=e,w.remoteFetching=!1,b=t,n&&(k=n.allowInsecureSubmissions||!1,n.debugMode&&(S=n.debugMode)),C},withCustomData:function(e){return b=e,C},withTags:function(e){j=e},attach:function(){return i()?(w.report.subscribe(f),y&&y.ajaxError(r),C):t},detach:function(){return w.report.unsubscribe(f),y&&y.unbind("ajaxError",r),C},send:function(e,n,t){try{f(w.computeStackTrace(e),{customData:u(b,n),tags:o(j,t)})}catch(r){if(e!==r)throw r}return C},setUser:function(e){return d={Identifier:e},C},setVersion:function(e){return v=e,C},saveIfOffline:function(e){return e!==t&&"boolean"==typeof e&&(T=e),T}};e.Raygun=C}(window,window.jQuery);