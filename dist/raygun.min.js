/*! Raygun4js - v1.5.2 - 2013-12-19
* https://github.com/MindscapeHQ/raygun4js
* Copyright (c) 2013 MindscapeHQ; Licensed MIT */
(function(n){function e(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function t(n){return n===undefined}var r={},i=n.TraceKit,u=[].slice,o="?";r.noConflict=function(){return n.TraceKit=i,r},r.wrap=function(n){function e(){try{return n.apply(this,arguments)}catch(e){throw r.report(e),e}}return e},r.report=function(){function t(n){a(),g.push(n)}function i(n){for(var e=g.length-1;e>=0;--e)g[e]===n&&g.splice(e,1)}function o(n,t){var i=null;if(!t||r.collectWindowErrors){for(var o in g)if(e(g,o))try{g[o].apply(null,[n].concat(u.call(arguments,2)))}catch(c){i=c}if(i)throw i}}function c(n,e,t){var i=null;if(p)r.computeStackTrace.augmentStackTraceWithInitialElement(p,e,t,n),i=p,p=null,h=null;else{var u={url:e,line:t};u.func=r.computeStackTrace.guessFunctionName(u.url,u.line),u.context=r.computeStackTrace.gatherContext(u.url,u.line),i={mode:"onerror",message:n,url:document.location.href,stack:[u],useragent:navigator.userAgent}}return o(i,"from window.onerror"),s?s.apply(this,arguments):!1}function a(){f!==!0&&(s=n.onerror,n.onerror=c,f=!0)}function l(e){var t=u.call(arguments,1);if(p){if(h===e)return;var i=p;p=null,h=null,o.apply(null,[i,null].concat(t))}var c=r.computeStackTrace(e);throw p=c,h=e,n.setTimeout(function(){h===e&&(p=null,h=null,o.apply(null,[c,null].concat(t)))},c.incomplete?2e3:0),e}var s,f,g=[],h=null,p=null;return l.subscribe=t,l.unsubscribe=i,l}(),r.computeStackTrace=function(){function i(e){function t(){try{return new n.XMLHttpRequest}catch(e){return new n.ActiveXObject("Microsoft.XMLHTTP")}}if(!r.remoteFetching)return"";try{var i=t();return i.open("GET",e,!1),i.send(""),i.responseText}catch(u){return""}}function u(n){if(!e(S,n)){var t="";-1!==n.indexOf(document.domain)&&(t=i(n)),S[n]=t?t.split("\n"):[]}return S[n]}function c(n,e){var r,i=/function ([^(]*)\(([^)]*)\)/,c=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,a="",l=10,s=u(n);if(!s.length)return o;for(var f=0;l>f;++f)if(a=s[e-f]+a,!t(a)){if(r=c.exec(a))return r[1];if(r=i.exec(a))return r[1]}return o}function a(n,e){var i=u(n);if(!i.length)return null;var o=[],c=Math.floor(r.linesOfContext/2),a=c+r.linesOfContext%2,l=Math.max(0,e-c-1),s=Math.min(i.length,e+a-1);e-=1;for(var f=l;s>f;++f)t(i[f])||o.push(i[f]);return o.length>0?o:null}function l(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function s(n){return l(n).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function f(n,e){for(var t,r,i=0,o=e.length;o>i;++i)if((t=u(e[i])).length&&(t=t.join("\n"),r=n.exec(t)))return{url:e[i],line:t.substring(0,r.index).split("\n").length,column:r.index-t.lastIndexOf("\n",r.index)-1};return null}function g(n,e,t){var r,i=u(e),o=RegExp("\\b"+l(n)+"\\b");return t-=1,i&&i.length>t&&(r=o.exec(i[t]))?r.index:null}function h(e){for(var t,r,i,u,o=[n.location.href],c=document.getElementsByTagName("script"),a=""+e,g=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,h=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,p=0;c.length>p;++p){var m=c[p];m.src&&o.push(m.src)}if(i=g.exec(a)){var d=i[1]?"\\s+"+i[1]:"",v=i[2].split(",").join("\\s*,\\s*");t=l(i[3]).replace(/;$/,";?"),r=RegExp("function"+d+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+t+"\\s*}")}else r=RegExp(l(a).replace(/\s+/g,"\\s+"));if(u=f(r,o))return u;if(i=h.exec(a)){var w=i[1];if(t=s(i[2]),r=RegExp("on"+w+"=[\\'\"]\\s*"+t+"\\s*[\\'\"]","i"),u=f(r,o[0]))return u;if(r=RegExp(t),u=f(r,o))return u}return null}function p(n){if(!n.stack)return null;for(var e,t,r=/^\s*at (?:((?:\[object object\])?\S+) )?\(?((?:file|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,i=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http|https).*?):(\d+)(?::(\d+))?\s*$/i,u=n.stack.split("\n"),l=[],s=/^(.*) is undefined$/.exec(n.message),f=0,h=u.length;h>f;++f){if(e=i.exec(u[f]))t={url:e[3],func:e[1]||o,args:e[2]?e[2].split(","):"",line:+e[4],column:e[5]?+e[5]:null};else{if(!(e=r.exec(u[f])))continue;t={url:e[2],func:e[1]||o,line:+e[3],column:e[4]?+e[4]:null}}!t.func&&t.line&&(t.func=c(t.url,t.line)),t.line&&(t.context=a(t.url,t.line)),l.push(t)}return l[0]&&l[0].line&&!l[0].column&&s&&(l[0].column=g(s[1],l[0].url,l[0].line)),l.length?{mode:"stack",name:n.name,message:n.message,url:document.location.href,stack:l,useragent:navigator.userAgent}:null}function m(n){for(var e,t=n.stacktrace,r=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,i=t.split("\n"),u=[],o=0,l=i.length;l>o;o+=2)if(e=r.exec(i[o])){var s={line:+e[1],column:+e[2],func:e[3]||e[4],args:e[5]?e[5].split(","):[],url:e[6]};if(!s.func&&s.line&&(s.func=c(s.url,s.line)),s.line)try{s.context=a(s.url,s.line)}catch(f){}s.context||(s.context=[i[o+1]]),u.push(s)}return u.length?{mode:"stacktrace",name:n.name,message:n.message,url:document.location.href,stack:u,useragent:navigator.userAgent}:null}function d(t){var r=t.message.split("\n");if(4>r.length)return null;var i,o,l,g,h=/^\s*Line (\d+) of linked script ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,p=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,m=/^\s*Line (\d+) of function script\s*$/i,d=[],v=document.getElementsByTagName("script"),w=[];for(o in v)e(v,o)&&!v[o].src&&w.push(v[o]);for(o=2,l=r.length;l>o;o+=2){var x=null;if(i=h.exec(r[o]))x={url:i[2],func:i[3],line:+i[1]};else if(i=p.exec(r[o])){x={url:i[3],func:i[4]};var y=+i[1],k=w[i[2]-1];if(k&&(g=u(x.url))){g=g.join("\n");var S=g.indexOf(k.innerText);S>=0&&(x.line=y+g.substring(0,S).split("\n").length)}}else if(i=m.exec(r[o])){var T=n.location.href.replace(/#.*$/,""),b=i[1],R=RegExp(s(r[o+1]));g=f(R,[T]),x={url:T,line:g?g.line:b,func:""}}if(x){x.func||(x.func=c(x.url,x.line));var C=a(x.url,x.line),E=C?C[Math.floor(C.length/2)]:null;x.context=C&&E.replace(/^\s*/,"")===r[o+1].replace(/^\s*/,"")?C:[r[o+1]],d.push(x)}}return d.length?{mode:"multiline",name:t.name,message:r[0],url:document.location.href,stack:d,useragent:navigator.userAgent}:null}function v(n,e,t,r){var i={url:e,line:t};if(i.url&&i.line){n.incomplete=!1,i.func||(i.func=c(i.url,i.line)),i.context||(i.context=a(i.url,i.line));var u=/ '([^']+)' /.exec(r);if(u&&(i.column=g(u[1],i.url,i.line)),n.stack.length>0&&n.stack[0].url===i.url){if(n.stack[0].line===i.line)return!1;if(!n.stack[0].line&&n.stack[0].func===i.func)return n.stack[0].line=i.line,n.stack[0].context=i.context,!1}return n.stack.unshift(i),n.partial=!0,!0}return n.incomplete=!0,!1}function w(n,e){for(var t,i,u,a=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,l=[],s={},f=!1,p=w.caller;p&&!f;p=p.caller)if(p!==x&&p!==r.report){if(i={url:null,func:o,line:null,column:null},p.name?i.func=p.name:(t=a.exec(""+p))&&(i.func=t[1]),u=h(p)){i.url=u.url,i.line=u.line,i.func===o&&(i.func=c(i.url,i.line));var m=/ '([^']+)' /.exec(n.message||n.description);m&&(i.column=g(m[1],u.url,u.line))}s[""+p]?f=!0:s[""+p]=!0,l.push(i)}e&&l.splice(0,e);var d={mode:"callers",name:n.name,message:n.message,url:document.location.href,stack:l,useragent:navigator.userAgent};return v(d,n.sourceURL||n.fileName,n.line||n.lineNumber,n.message||n.description),d}function x(n,e){var t=null;e=null==e?0:+e;try{if(t=m(n))return t}catch(r){if(k)throw r}try{if(t=p(n))return t}catch(r){if(k)throw r}try{if(t=d(n))return t}catch(r){if(k)throw r}try{if(t=w(n,e+1))return t}catch(r){if(k)throw r}return{mode:"failed"}}function y(n){n=(null==n?0:+n)+1;try{throw Error()}catch(e){return x(e,n+1)}return null}var k=!1,S={};return x.augmentStackTraceWithInitialElement=v,x.guessFunctionName=c,x.gatherContext=a,x.ofCaller=y,x}(),function(){var e=function e(e){var t=n[e];n[e]=function(){var n=u.call(arguments),e=n[0];return"function"==typeof e&&(n[0]=r.wrap(e)),t.apply?t.apply(this,n):t(n[0],n[1])}};e("setTimeout"),e("setInterval")}(),r.remoteFetching||(r.remoteFetching=!0),r.collectWindowErrors||(r.collectWindowErrors=!0),(!r.linesOfContext||1>r.linesOfContext)&&(r.linesOfContext=11),n.TraceKit=r})(window),function(n,e){"use strict";if(n){var t=n.event.add;n.event.add=function(r,i,u,o,c){var a;return u.handler?(a=u.handler,u.handler=e.wrap(u.handler)):(a=u,u=e.wrap(u)),u.guid=a.guid?a.guid:a.guid=n.guid++,t.call(this,r,i,u,o,c)};var r=n.fn.ready;n.fn.ready=function(n){return r.call(this,e.wrap(n))};var i=n.ajax;n.ajax=function(t,r){"object"==typeof t&&(r=t,t=void 0),r=r||{};for(var u,o=["complete","error","success"];u=o.pop();)n.isFunction(r[u])&&(r[u]=e.wrap(r[u]));try{return t?i.call(this,t,r):i.call(this,r)}catch(c){throw e.report(c),c}}}}(window.jQuery||window.Zepto||window.ender,window.TraceKit),function(n,e,t){function r(n,e,r,i){T.send(i||n.type,{status:e.status,statusText:e.statusText,type:r.type,url:r.url,contentType:r.contentType,data:r.data?r.data.slice(0,10240):t})}function i(e){n.console&&n.console.log&&y&&n.console.log(e)}function u(){return p&&""!==p?!0:(i("Raygun API key has not been configured, make sure you call Raygun.init(yourApiKey)"),!1)}function o(n,e){var t,r={};for(t in n)r[t]=n[t];for(t in e)r[t]=e[t];return r}function c(n,e){for(var t=0;n.length>t;t++)e.call(null,t,n[t])}function a(n){for(var e in n)if(n.hasOwnProperty(e))return!1;return!0}function l(){var e=document.documentElement,t=document.getElementsByTagName("body")[0],r=n.innerWidth||e.clientWidth||t.clientWidth,i=n.innerHeight||e.clientHeight||t.clientHeight;return{width:r,height:i}}function s(e,t){var r=[],i={};e.stack&&e.stack.length&&c(e.stack,function(n,e){r.push({LineNumber:e.line,ClassName:"line "+e.line+", column "+e.column,FileName:e.url,MethodName:e.func||"[anonymous]"})}),n.location.search&&n.location.search.length>1&&c(n.location.search.substring(1).split("&"),function(n,e){var t=e.split("=");t&&2===t.length&&(i[decodeURIComponent(t[0])]=t[1])}),a(t)&&(t=S);var u=n.screen||{width:l().width,height:l().height,colorDepth:8},o={OccurredOn:new Date,Details:{Error:{ClassName:e.name,Message:e.message||t.status||"Script error",StackTrace:r},Environment:{UtcOffset:(new Date).getTimezoneOffset()/-60,"User-Language":navigator.userLanguage,"Document-Mode":document.documentMode,"Browser-Width":l().width,"Browser-Height":l().height,"Screen-Width":u.width,"Screen-Height":u.height,"Color-Depth":u.colorDepth,Browser:navigator.appCodeName,"Browser-Name":navigator.appName,"Browser-Version":navigator.appVersion,Platform:navigator.platform},Client:{Name:"raygun-js",Version:"1.5.0"},UserCustomData:t,Request:{Url:document.location.href,QueryString:i,Headers:{"User-Agent":navigator.userAgent,Referer:document.referrer,Host:document.domain}},Version:d||"Not supplied"}};m&&(o.Details.User=m),f(o)}function f(n){if(u()){i("Sending exception data to Raygun:",n);var e="https://api.raygun.io/entries?apikey="+encodeURIComponent(p);h(e,JSON.stringify(n))}}function g(e,t){var r;return r=new n.XMLHttpRequest,"withCredentials"in r?r.open(e,t,!0):n.XDomainRequest&&(k&&(t=t.slice(6)),r=new n.XDomainRequest,r.open(e,t)),r.onload=function(){i("logged error to Raygun")},r.onerror=function(){i("failed to log error to Raygun")},r}function h(n,e){var r=g("POST",n);return r?(r.send(e),t):(i("CORS not supported"),t)}var p,m,d,v,w=TraceKit.noConflict(),x=n.Raygun,y=!1,k=!1,S={};e&&(v=e(document));var T={noConflict:function(){return n.Raygun=x,T},init:function(n,e,t){return p=n,w.remoteFetching=!1,S=t,e&&(k=e.allowInsecureSubmissions||!1,e.debugMode&&(y=e.debugMode)),T},withCustomData:function(n){return S=n,T},attach:function(){return u()?(w.report.subscribe(s),v&&v.ajaxError(r),T):t},detach:function(){return w.report.unsubscribe(s),v&&v.unbind("ajaxError",r),T},send:function(n,e){try{s(w.computeStackTrace(n),o(S,e))}catch(t){if(n!==t)throw t}return T},setUser:function(n){return m={Identifier:n},T},setVersion:function(n){return d=n,T}};n.Raygun=T}(window,window.jQuery||window.Zepto||window.ender);